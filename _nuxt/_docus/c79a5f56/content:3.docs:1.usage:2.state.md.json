{"key":"content:3.docs:1.usage:2.state.md","generatedAt":"2021-10-13T13:08:12.964Z","mtime":"2021-10-13T13:08:12.956Z","slug":"state","title":"State","position":"000300010002","to":"/docs/usage/state","draft":false,"page":true,"language":"en","empty":false,"description":"Nuxt provides useState to create a globally shared state.","body":{"raw":"# State\n\nNuxt provides `useState` to create a globally shared state.\n\n## `useState`\n\nWithin your pages, components and plugins you can use `useState`. It can be used to create your own store implementation.\n\nYou can think of it as an SSR-friendly ref in that its value will be hydrated (preserved) after server-side rendering. It is shared across all components.\n\n\n### Usage\n\n```js\nuseState(key: string)\n```\n\n* **key**: a unique key to ensure that data fetching can be properly de-duplicated across requests\n\n### Example\n\nIn this example, we use a server-only plugin to find about request locale.\n\n```ts [plugins/locale.server.ts]\nimport { defineNuxtPlugin, useState } from '#app'\n\nexport default defineNuxtPlugin((nuxt) => {\n  const locale = useState('locale')\n  locale.value = nuxt.ssrContext.req.headers['accept-language']?.split(',')[0]\n})\n```\n\n```vue\n<script setup>\nconst locale = useState('locale')\n</script>\n\n<template>\n  Current locale: {{ locale }}\n</template>\n```\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"state"},"children":[{"type":"text","value":"State"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"Nuxt provides "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"useState"}]},{"type":"text","value":" to create a globally shared state."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"usestate"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#usestate"},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"useState"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Within your pages, components and plugins you can use "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"useState"}]},{"type":"text","value":". It can be used to create your own store implementation."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"You can think of it as an SSR-friendly ref in that its value will be hydrated (preserved) after server-side rendering. It is shared across all components."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"usage"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#usage"},"children":[{"type":"text","value":"Usage"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"useState"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"key"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" string"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-strong","props":{},"children":[{"type":"text","value":"key"}]},{"type":"text","value":": a unique key to ensure that data fetching can be properly de-duplicated across requests"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"example"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#example"},"children":[{"type":"text","value":"Example"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"In this example, we use a server-only plugin to find about request locale."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"plugins/locale.server.ts"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-ts"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" defineNuxtPlugin"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" useState "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'#app'"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"defineNuxtPlugin"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"nuxt"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" locale "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"useState"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'locale'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  locale"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"value "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" nuxt"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"ssrContext"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"req"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"text","value":"headers"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'accept-language'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"?."}]},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"split"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"','"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"0"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"script"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"setup"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"span","props":{"className":["token","script"]},"children":[{"type":"element","tag":"span","props":{"className":["token","language-javascript"]},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" locale "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"useState"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'locale'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  Current locale: {{ locale }}\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"usestate","depth":2,"text":"useState","children":[{"id":"usage","depth":3,"text":"Usage"},{"id":"example","depth":3,"text":"Example"}]}]}}}