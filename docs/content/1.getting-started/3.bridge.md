# Bridge

åœ¨ç°æœ‰Nuxt2ä¸Šä½“éªŒNuxt3çš„æ–°ç‰¹æ€§

::alert
å¦‚æœæ‚¨æƒ³æ–°å»ºNuxt3é¡¹ç›®ï¼Œè¯·è·³è¿‡æ­¤éƒ¨åˆ†å¹¶é˜…è¯»[Nuxt 3 Installation](/getting-started/installation).<br>
äº†è§£æ›´å¤š [Introduction](/getting-started/introduction).
::

Bridgeæ˜¯å‘å‰å…¼å®¹çš„ï¼Œé€šè¿‡ç®€å•çš„å®‰è£…å’Œå¯ç”¨Nuxtæ¨¡å—ï¼Œå°±å¯ä»¥è®©ä½ ä½“éªŒåˆ°å¾ˆå¤šNuxt 3çš„æ–°ç‰¹æ€§ã€‚ 

ä½¿ç”¨Nuxt Bridge, å¯ç¡®ä¿è®©æ‚¨çš„é¡¹ç›®æ— éœ€å¤§é‡é‡å†™æˆ–åšé£é™©æ€§å˜åŠ¨ï¼Œå‡ ä¹å°±å¯ä»¥å‡†å¤‡å¥½Nuxt 3ï¼Œå¹¶ä¸”æ‹¥æœ‰æœ€å¥½çš„å¼€å‘ä½“éªŒã€‚


### å‡çº§Nuxt 2

åˆ é™¤packageé”æ–‡ä»¶ (`package-lock.json` and `yarn.lock`)å¹¶ä¸”ä½¿ç”¨æœ€æ–°çš„`nuxt-edge`:

**package.json**

```diff
- "nuxt": "^2.15.0"
+ "nuxt-edge": "latest"
```

æ¥ç€ï¼Œè¯·é‡è£…ä¾èµ–ç»„ä»¶ï¼š

::code-group
```bash [Yarn]
yarn install
```
```bash [NPM]
npm install
```
::

::alert
å¦‚æœå®‰è£…å®Œæˆï¼Œè¯·ç¡®ä¿developmentå’Œproductionä¸¤ç§ç¯å¢ƒå¯ä»¥å¦‚é¢„æœŸä¸€æ ·è¿è¡Œã€‚
::

### å®‰è£…Nuxt Bridge

å®‰è£… `@nuxt/bridge-edge` ä½œä¸ºå¼€å‘ä¾èµ–:

::code-group
```bash [NPM]
npm install -D @nuxt/bridge@npm:@nuxt/bridge-edge
```
```bash [Yarn]
yarn add --dev @nuxt/bridge@npm:@nuxt/bridge-edge
```
::

### æ›´æ–°`nuxt.config`

è¯·é¿å…åœ¨æ‚¨çš„é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨ä»»ä½•çš„CommonJSè¯­æ³•ï¼Œä¾‹å¦‚ `module.exports`, `require` æˆ–è€… `require.resolve` ã€‚å› ä¸ºå®ƒå·²ç»è¢«å¼ƒç”¨ä¸”ä¸å†æ”¯æŒã€‚

æ‚¨å¯ä»¥ä½¿ç”¨é™æ€ `import`, åŠ¨æ€ `import()` ä»¥åŠ `export default`ã€‚ä½¿ç”¨é‡å‘½åä¸º`nuxt.config.ts`çš„TypeScriptä¹Ÿæ˜¯å¯è¡Œçš„ã€‚

```ts [nuxt.config.js]
import { defineNuxtConfig } from '@nuxt/bridge'

export default defineNuxtConfig({
  // Your existing configuration
})
```

### é¿å…ä½¿ç”¨CommonJSè¯­æ³•

Nuxt 3å¤©ç„¶åœ°æ”¯æŒTypeScriptå’ŒECMAScript Modules.

#### æ›´æ–°imports

::code-group
```js [Before]
const lib = require('lib')
```
```js [After]
import lib from 'lib'
// or using code-splitting
const lib = await import('lib').then(e => e.default || e)
```
::

#### æ›´æ–°exports

::code-group
```js [Before]
module.exports = ...
```
```js [After]
export default ...
// or using named export
export const hello = ...
```
::

#### é¿å…ä½¿ç”¨ç‰¹æ®Šçš„CJSè¯­æ³•

å°½å¯èƒ½é¿å…ä½¿ç”¨ `__dirname` å’Œ `__filename`ã€‚

### åˆ é™¤ä¸ç›¸å®¹å’ŒåºŸå¼ƒçš„æ¨¡å—

- Remove `@nuxt/content` (1.x). A rewrite for nuxt 3 is planned (2.x)
- Remove `nuxt-vite`: Bridge enables same functionality
- Remove `@nuxtjs/typescript-build`: Bridge enables same functionality
- Remove `@nuxtjs/typescript-runtime` and `nuxt-ts`: Nuxt 2 has built-in runtime support
- Remove `@nuxt/nitro`: Bridge injects same functionality
- Remove `@nuxtjs/composition-api`: Bridge provides a Nuxt 3 compatible composition-api layer and help to remove dependency

### ç¡®ä¿ä¸€åˆ‡æ­£å¸¸è¿è¡Œ

âœ”ï¸ ä½¿ç”¨ `nuxt dev` å’Œ `nuxt build` (æˆ–è€… `nuxt generate`) æ£€æŸ¥ä¸€åˆ‡æ˜¯å¦æ­£å¸¸è¿è¡Œ

ğŸ› å¦‚æœå‡ºé”™å•¦ï¼Ÿè¯·å‘ŠçŸ¥æˆ‘ä»¬ã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥å¾ˆè½»æ¾åœç”¨bridge:

```ts [nuxt.config.js]
import { defineNuxtConfig } from '@nuxt/bridge'

export default defineNuxtConfig({
  bridge: false // Temporarily disable bridge integration
})
```
