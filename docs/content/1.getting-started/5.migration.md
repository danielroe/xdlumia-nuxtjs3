# è¿ç§»

Nuxt 3 è¿ç§»æŒ‡å—ã€‚å·¥ä½œæ­£åœ¨è¿›è¡Œä¸­ ğŸš§

## Nuxt 2 to Nuxt 3

ç›®å‰ï¼Œæ²¡æœ‰ Nuxt 2 åˆ° Nuxt 3 è¿ç§»æŒ‡å—ï¼Œä¹Ÿä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºå¯èƒ½ä¼šæœ‰æ›´å¤šå˜åŒ–ã€‚æˆ‘ä»¬æ­£åœ¨åŠªåŠ›æä¾›ç¨³å®šçš„è¿ç§»æŒ‡å—å’Œå·¥å…·ï¼Œä»¥ä½¿å…¶å°½å¯èƒ½é¡ºåˆ©ã€‚è¯·æ£€æŸ¥[Bridge](/getting-started/bridge) ä»¥è·å–æ›¿ä»£æ–¹æ¡ˆã€‚

Nuxt 2 åˆ é™¤äº†ä¸€äº›åŠŸèƒ½ï¼Œä¸€äº›åŠŸèƒ½å°šæœªåœ¨ Nuxt 3 ä¸­å®ç°ï¼Œè¿˜æœ‰ä¸€äº›æ˜¯ Nuxt 3ï¼ˆå’Œ Bridgeï¼‰ä¸­çš„æ–°åŠŸèƒ½ã€‚

é™¤äº† Nuxt Bridge çš„è¦æ±‚ä¹‹å¤–ï¼ŒNuxt 3 çš„æ˜¾ç€å’Œ/æˆ–é‡å¤§æ›´æ”¹åŒ…æ‹¬ï¼š

::list{type=warning}
- Vue åº”ç”¨ç¨‹åºæ¨¡æ¿è¢«é‡å†™
- Vue å‡çº§ä¸º `3.x`
- ä½¿ç”¨ `<Suspense>` è¿›è¡Œå¼‚æ­¥æ•°æ®è¯»å–
- Webpack `5.x` (å¦‚æœä¸ä½¿ç”¨ `vite`)
- é‡æ–°è‡ªåŠ¨è·å–ç»„ä»¶
- å¼•å…¥ä¸»è¦ç»„ä»¶ [`app.vue`](/docs/directory-structure/app)
- å¼•å…¥æ–°çš„ [`layouts` ç³»ç»Ÿ](/docs/directory-structure/layouts)
- [`pages/` ç›®å½•](/docs/directory-structure/pages) conventions changed
::

ä¸‹é¢çš„è¡¨æ˜¯ä¸€ä¸ªæ•´ä½“ç‰¹å¾æ¯”è¾ƒ:

åŠŸèƒ½ / ç‰ˆæœ¬         | Nuxt 2  | Nuxt 3   | éœ€è¦æ›´æ”¹
--------------------------|---------|----------|------------------
Vue ç‰ˆæœ¬               | 2       | 3        | Yes
`app.vue`                 | âŒ      | âœ…        | -
Assets                    | âœ…      | âœ…        | No
Components                | âœ…      | âœ…        | No
Layouts                   | âœ…      | âœ…        | Yes
Error Pages               | âœ…      | ğŸš§        | Yes
Pages                     | âœ…      | âœ…        | Yes
Pages: Dynamic Params     | âœ…      | âœ…        | Yes
Pages: _.vue              | âœ…      | âœ…        | No
Plugins                   | âœ…      | âœ…        | Yes (compatible by default)
Store                     | âœ…      | ğŸš§        | Yes
Transitions               | âœ…      | ğŸš§        | ?
Suspense                  | âŒ      | âœ…        | -
Options API: `asyncData`  | âœ…      | ğŸš§        | ?
Options API: `fetch`      | âœ…      | ğŸš§        | ?

### æ¨¡å—å…¼å®¹æ€§

All Nuxt 2 modules should be forward compatible with Nuxt 3 as long as they migrate to bridge or if they are already following guidelines.

All (upcoming) modules made with `@nuxt/kit` should be backward compatible with Nuxt 2 projects (even without bridge) as long as they are not depending on a Nuxt 3 / Bridge-only feature.

### æ’ä»¶å…¼å®¹æ€§

Most Nuxt 2 plugins should be forward compatible with Nuxt 3 with a magical compat layer we inject.

Nuxt 3 plugins are **not** backward compatible with Nuxt 2.

### Vue å…¼å®¹æ€§

å¯¹äºä½¿ç”¨ç»„åˆ composition API or components, it needs exclusive Vue 2 or Vue 3 support.

By using [vue-demi](https://github.com/vueuse/vue-demi) they should be compatible with both Nuxt 2 and 3.

## Module Migration

When Nuxt 3 users add your module, a compatible module container layer from `@nuxt/kit` is **automatically injected**, so as long as your code is following the guidelines below, it should continue working as-is.

### Test with `@nuxt/bridge`

Migrating to `@nuxt/bridge` is the first and most important step for supporting Nuxt 3.

If you have a fixture or example in your module, add `@nuxt/bridge` package to its config (see [example](/getting-started/bridge#update-nuxtconfig))

### Avoid CommonJS syntax

Nuxt 3 natively supports TypeScript and ECMAScript Modules.

#### Update the imports

::code-group
```js [Before]
const lib = require('lib')
```
```js [After]
import lib from 'lib'
// or using code-splitting
const lib = await import('lib').then(e => e.default || e)
```
::

#### Update the exports

::code-group
```js [Before]
module.exports = ...
```
```js [After]
export default ...
// or using named export
export const hello = ...
```
::

#### Avoid using specific CJS syntax

Avoid the usage of `__dirname` and `__filename` as much as possible.

### Ensure plugins default export

If you inject a Nuxt plugin that does not have `export default` (such as global Vue plugins), ensure you add `export default {}` to the end of it.

::code-group
```js [Before]
// ~/plugins/vuelidate.js
import Vue from 'vue'
import Vuelidate from 'vuelidate'

Vue.use(Vuelidate)
```
```js [After]
// ~/plugins/vuelidate.js
import Vue from 'vue'
import Vuelidate from 'vuelidate'

Vue.use(Vuelidate)

export default {}
```
::

### Avoid runtime modules

With Nuxt 3, Nuxt is now a build-time-only dependency, which means that modules shouldn't attempt to hook into the Nuxt runtime.

Your module needs should work even if it's only added to [`buildModules`](/docs/directory-structure/nuxt.config#buildmodules) (instead of `modules`). For example:

- Avoid updating `process.env` within a Nuxt module and reading by a nuxt plugin; use [`runtimeConfig`](/docs/directory-structure/nuxt.config#publicruntimeconfig) instead.
- (*) Avoid depending on runtime hooks like `vue-renderer:*` for production
- (*) Avoid adding `serverMiddleware` by importing them inside module. Instead, add them by referencing a file path so that they are independent of module context

(*) Unless it is for `nuxt dev` purpose only and guarded with `if (nuxt.options.dev) { }`.

### Add module meta

Ensure your module is exporting meta object.

\[TODO\]

### Use TypeScript (optional)

While it is not essential, most of the Nuxt ecosystem is shifting to use TypeScript, so it is highly recommended to consider migration.

::alert{icon=ğŸ’¡}
You can start migration by simply renaming `.js` files, to `.ts`. TypeScript is designed to be progressive!
::

::alert{icon=ğŸ’¡}
You can use TypeScript syntax for Nuxt 2 and 3 modules and plugins without any extra dependencies.
::
